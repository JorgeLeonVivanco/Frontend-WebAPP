<app-navbar></app-navbar>

<div class="property-detail-container">
  <h3>{{ propiedadSeleccionada.direccion || 'Sin dirección especificada' }}</h3>

  <!-- Imágenes -->
  <div class="images-gallery">
    <img
      *ngFor="let imagen of propiedadSeleccionada.imagenes"
      [src]="imagen"
      alt="Imagen de la propiedad"
      class="gallery-image"
    />
  </div>

 <!-- Detalles -->
 <div class="property-details">
  <h4>Servicios</h4>
  <ul *ngIf="propiedadSeleccionada.servicios.length > 0; else noServicios">
    <li *ngFor="let servicio of propiedadSeleccionada.servicios">{{ servicio }}</li>
  </ul>
  <ng-template #noServicios>
    <p>No se especificaron servicios.</p>
  </ng-template>
</div>

 <!-- Calificaciones y Comentarios -->
<div class="property-ratings">
  <h4>Calificaciones y Comentarios</h4>

<!-- Mostrar comentarios existentes -->
<div *ngIf="propiedadSeleccionada?.comentarios?.length > 0; else noComentarios">
  <h5>Comentarios</h5>
  <div *ngFor="let comentario of propiedadSeleccionada.comentarios" class="comentario">
    <p>
      <strong>{{ comentario.usuario || 'Usuario desconocido' }}</strong>
      <span class="fecha">{{ comentario.fecha | date: 'short' }}</span>
    </p>
    <p>{{ comentario.texto || 'Sin texto' }}</p>
  </div>
</div>

  <!-- Plantilla para mostrar si no hay comentarios -->
  <ng-template #noComentarios>
    <p>No hay comentarios disponibles para esta propiedad.</p>
  </ng-template>

  <!-- Formulario para agregar un nuevo comentario -->
  <div class="add-comment">
    <h5>Agregar un comentario</h5>
    <textarea
      [(ngModel)]="nuevoComentario.texto"
      placeholder="Escribe tu comentario aquí..."
      rows="3"
      class="form-control">
    </textarea>
    <button (click)="agregarComentario()" class="btn btn-primary mt-2">Agregar comentario</button>
  </div>
</div>


  <!-- Ubicación -->
  <div class="map-container">
    <h4>Ubicación</h4>
    <iframe
      *ngIf="propiedadSeleccionada.mapaUrl"
      [src]="propiedadSeleccionada.mapaUrl"
      width="100%"
      height="300"
      style="border: 0;"
      allowfullscreen=""
      loading="lazy"
    ></iframe>
    <p *ngIf="!propiedadSeleccionada.mapaUrl">No hay ubicación disponible.</p>
  </div>

  <!-- Información del propietario -->
  <div class="owner-details">
    <h4>Propietario</h4>
    <p><strong>{{ propiedadSeleccionada.propietario.nombre || 'Sin propietario especificado' }}</strong></p>
    <p><strong>Correo:</strong> {{ propiedadSeleccionada.propietario.correo || 'Sin correo especificado' }}</p>
    <p><strong>Teléfono:</strong> {{ propiedadSeleccionada.propietario.telefono || 'Sin teléfono especificado' }}</p>
  </div>

</div>
